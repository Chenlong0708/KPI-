<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>团队协作式KPI周报系统 | Team KPI Collaboration System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #1a6dcc;
            --primary-light: #2c87e6;
            --secondary: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --light-bg: #f8fbff;
            --border: #d1e0f0;
            --text: #333;
            --text-light: #6c757d;
            --sidebar-bg: #2c3e50;
            --online: #28a745;
            --offline: #6c757d;
            --editing: #2c87e6;
            --card-bg: #ffffff;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            overflow-x: hidden;
        }
        
        /* 侧边导航 */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            color: white;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            box-shadow: 3px 0 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .logo {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo h2 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
        }
        
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .nav-links {
            flex: 1;
        }
        
        .nav-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: background 0.3s;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover, .nav-item.active {
            background: rgba(255,255,255,0.1);
            border-left: 3px solid var(--primary-light);
        }
        
        .nav-item i {
            width: 24px;
            text-align: center;
        }
        
        .team-members {
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .team-members h3 {
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .member {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            padding: 8px;
            border-radius: 6px;
        }
        
        .member:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .member-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
        }
        
        .member-status {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            bottom: -2px;
            right: -2px;
            border: 2px solid var(--sidebar-bg);
        }
        
        .status-online {
            background: var(--online);
        }
        
        .status-offline {
            background: var(--offline);
        }
        
        .status-editing {
            background: var(--editing);
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        /* 主内容区 */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .date-range {
            display: flex;
            align-items: center;
            background: var(--card-bg);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: var(--shadow);
        }
        
        .date-range i {
            margin-right: 10px;
            color: var(--primary-light);
            font-size: 1.3rem;
        }
        
        .user-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--card-bg);
            padding: 8px 15px;
            border-radius: 30px;
            box-shadow: var(--shadow);
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary-light);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            color: white;
            box-shadow: 0 4px 12px rgba(26, 109, 204, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, #155db3, var(--primary));
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(26, 109, 204, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(to right, var(--secondary), #3cc05a);
            color: white;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        .btn-success:hover {
            background: linear-gradient(to right, #228e3a, var(--secondary));
            transform: translateY(-2px);
        }
        
        .btn-light {
            background: var(--card-bg);
            color: var(--primary-light);
            box-shadow: var(--shadow);
        }
        
        .btn-light:hover {
            background: #f0f7ff;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: linear-gradient(to right, var(--danger), #e4606d);
            color: white;
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }
        
        .btn-danger:hover {
            background: linear-gradient(to right, #bd2130, var(--danger));
            transform: translateY(-2px);
        }
        
        /* 内容区域 */
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
        
        /* KPI 表格 */
        .table-container {
            background: var(--card-bg);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }
        
        th {
            background: linear-gradient(to bottom, var(--primary-light), var(--primary));
            color: white;
            text-align: left;
            padding: 18px 15px;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        .bilingual-header {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .bilingual-header span:first-child {
            font-weight: 700;
        }
        
        .bilingual-header span:last-child {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        td {
            padding: 16px 15px;
            border-bottom: 1px solid #eef2f7;
            vertical-align: top;
        }
        
        tr:nth-child(even) {
            background-color: #f9fcff;
        }
        
        tr:hover {
            background-color: #f0f7ff;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.95rem;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(44, 135, 230, 0.2);
        }
        
        textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .status-select {
            padding: 8px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            display: inline-block;
            min-width: 100px;
            border: 1px solid transparent;
        }
        
        .status-planned {
            background: #f0f7ff;
            color: var(--primary-light);
            border-color: #c0d9f5;
        }
        
        .status-in-progress {
            background: #fff8e6;
            color: var(--warning);
            border-color: #ffeeba;
        }
        
        .status-completed {
            background: #e8f7ee;
            color: var(--secondary);
            border-color: #c3e6cb;
        }
        
        .status-blocked {
            background: #fce8e8;
            color: var(--danger);
            border-color: #f5c6cb;
        }
        
        .add-row-btn {
            padding: 15px;
            text-align: center;
            background: #f0f7ff;
            cursor: pointer;
            color: var(--primary-light);
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .add-row-btn:hover {
            background: #e1eeff;
        }
        
        .remove-row {
            color: var(--danger);
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s;
            padding: 5px;
        }
        
        .remove-row:hover {
            opacity: 1;
        }
        
        /* 团队管理 */
        .team-management {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .team-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        
        .team-card h3 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .member-details {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background: var(--light-bg);
        }
        
        .member-details:hover {
            background: #e1eeff;
        }
        
        .member-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        /* 报表区域 */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .chart-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        
        .chart-card h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-container {
            height: 300px;
            position: relative;
        }
        
        /* 添加成员表单 */
        .add-member-form {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            display: none;
        }
        
        .add-member-form.active {
            display: block;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            flex: 1;
            min-width: 250px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-buttons {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }
        
        /* 通知 */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* 语言切换 */
        .language-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 30px;
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .lang-btn {
            background: transparent;
            border: none;
            color: white;
            font-weight: 600;
            cursor: pointer;
            padding: 5px 15px;
            border-radius: 20px;
            transition: background 0.3s;
        }
        
        .lang-btn.active {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .footer {
            text-align: center;
            padding: 25px 0;
            color: var(--text-light);
            font-size: 0.95rem;
            border-top: 1px solid #eaeff5;
            margin-top: 20px;
        }
        
        /* 响应式设计 */
        @media (max-width: 1100px) {
            .sidebar {
                position: fixed;
                left: -260px;
                height: 100vh;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .user-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .chart-card {
                min-width: 100%;
                overflow-x: auto;
            }
            
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- 侧边导航 -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <h2><i class="fas fa-chart-line"></i> KPI周报系统</h2>
            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <div class="nav-links">
            <div class="nav-item active" data-section="dashboard">
                <i class="fas fa-home"></i> <span class="lang" data-key="navDashboard">仪表盘</span>
            </div>
            <div class="nav-item" data-section="kpi-report">
                <i class="fas fa-file-alt"></i> <span class="lang" data-key="navKPI">KPI周报</span>
            </div>
            <div class="nav-item" data-section="team-management">
                <i class="fas fa-users"></i> <span class="lang" data-key="navTeam">团队管理</span>
            </div>
            <div class="nav-item" data-section="reports">
                <i class="fas fa-chart-bar"></i> <span class="lang" data-key="navReports">报表分析</span>
            </div>
        </div>
        
        <div class="team-members">
            <h3><i class="fas fa-user-friends"></i> <span class="lang" data-key="teamMembers">团队成员</span> (<span id="member-count">5</span>)</h3>
            <div id="team-members-list">
                <!-- 团队成员列表将由JavaScript生成 -->
            </div>
        </div>
        
        <div class="language-switch">
            <button class="lang-btn active" data-lang="zh">中文</button>
            <button class="lang-btn" data-lang="en">English</button>
        </div>
    </div>
    
    <!-- 主内容区 -->
    <div class="main-content">
        <!-- 仪表盘 -->
        <div class="content-section active" id="dashboard">
            <div class="header">
                <div class="date-range">
                    <i class="far fa-calendar-alt"></i>
                    <span><span class="lang" data-key="currentPeriod">当前周期</span>: <span id="current-week">2023年11月20日 - 2023年11月26日</span></span>
                </div>
                
                <div class="user-controls">
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="switchSection('kpi-report')">
                            <i class="fas fa-file-alt"></i> <span class="lang" data-key="goToReport">进入周报</span>
                        </button>
                        <button class="btn btn-success" onclick="switchSection('reports')">
                            <i class="fas fa-chart-bar"></i> <span class="lang" data-key="viewReports">查看报表</span>
                        </button>
                    </div>
                    
                    <div class="user-info">
                        <div class="user-avatar">王</div>
                        <div><input type="text" id="username" value="王芳" style="width: 80px; background: transparent; border: none;"></div>
                    </div>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-card">
                    <h3><i class="fas fa-tasks"></i> <span class="lang" data-key="taskStatus">任务状态分布</span></h3>
                    <div class="chart-container">
                        <canvas id="taskStatusChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3><i class="fas fa-bullseye"></i> <span class="lang" data-key="kpiProgress">KPI进度追踪</span></h3>
                    <div class="chart-container">
                        <canvas id="kpiProgressChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th width="25%"><span class="lang" data-key="recentUpdates">最近更新</span></th>
                            <th width="25%"><span class="lang" data-key="updatedBy">更新人</span></th>
                            <th width="25%"><span class="lang" data-key="section">区域</span></th>
                            <th width="25%"><span class="lang" data-key="time">时间</span></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="lang" data-key="update1">完成客服团队培训</span></td>
                            <td>张明</td>
                            <td>KPI周报</td>
                            <td>2023-11-22 10:30</td>
                        </tr>
                        <tr>
                            <td><span class="lang" data-key="update2">添加了新的市场分析</span></td>
                            <td>李华</td>
                            <td>KPI周报</td>
                            <td>2023-11-22 09:15</td>
                        </tr>
                        <tr>
                            <td><span class="lang" data-key="update3">更新了团队信息</span></td>
                            <td>王芳</td>
                            <td>团队管理</td>
                            <td>2023-11-21 16:45</td>
                        </tr>
                        <tr>
                            <td><span class="lang" data-key="update4">导出了本周报告</span></td>
                            <td>赵雷</td>
                            <td>报表分析</td>
                            <td>2023-11-21 14:20</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- KPI周报 -->
        <div class="content-section" id="kpi-report">
            <div class="header">
                <div class="date-range">
                    <i class="far fa-calendar-alt"></i>
                    <span><span class="lang" data-key="currentPeriod">当前周期</span>: <span id="current-week-kpi">2023年11月20日 - 2023年11月26日</span></span>
                </div>
                
                <div class="user-controls">
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="addNewRow()">
                            <i class="fas fa-plus-circle"></i> <span class="lang" data-key="addRow">添加新行</span>
                        </button>
                        <button class="btn btn-success" onclick="exportToExcel()">
                            <i class="fas fa-file-excel"></i> <span class="lang" data-key="exportExcel">导出Excel</span>
                        </button>
                        <button class="btn btn-light" onclick="saveData()">
                            <i class="fas fa-save"></i> <span class="lang" data-key="saveData">保存数据</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <table id="kpi-table">
                    <thead>
                        <tr>
                            <th width="14%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="coreKPI">核心KPI (目标值)</span>
                                    <span class="lang" data-key="coreKPI_en">Core KPI (Target)</span>
                                </div>
                            </th>
                            <th width="12%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="keyActions">支撑性关键行动/项目</span>
                                    <span class="lang" data-key="keyActions_en">Key Actions/Projects</span>
                                </div>
                            </th>
                            <th width="14%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="weekReview">本周重点回顾</span>
                                    <span class="lang" data-key="weekReview_en">Weekly Review</span>
                                </div>
                            </th>
                            <th width="12%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="completionStatus">完成状态/结果</span>
                                    <span class="lang" data-key="completionStatus_en">Completion Status/Results</span>
                                </div>
                            </th>
                            <th width="14%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="nextWeekPlan">下周重点计划</span>
                                    <span class="lang" data-key="nextWeekPlan_en">Next Week Plan</span>
                                </div>
                            </th>
                            <th width="12%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="expectedOutput">预期输出/截止日</span>
                                    <span class="lang" data-key="expectedOutput_en">Expected Output/Deadline</span>
                                </div>
                            </th>
                            <th width="10%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="responsible">责任人</span>
                                    <span class="lang" data-key="responsible_en">Responsible</span>
                                </div>
                            </th>
                            <th width="8%">
                                <div class="bilingual-header">
                                    <span class="lang" data-key="status">状态</span>
                                    <span class="lang" data-key="status_en">Status</span>
                                </div>
                            </th>
                            <th width="4%"></th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- KPI表格内容将由JavaScript生成 -->
                    </tbody>
                </table>
                <div class="add-row-btn" onclick="addNewRow()">
                    <i class="fas fa-plus-circle"></i> <span class="lang" data-key="addRow">添加新行</span>
                </div>
            </div>
        </div>
        
        <!-- 团队管理 -->
        <div class="content-section" id="team-management">
            <div class="header">
                <h2><i class="fas fa-users"></i> <span class="lang" data-key="teamManagement">团队管理</span></h2>
                <div class="user-controls">
                    <button class="btn btn-primary" onclick="toggleMemberForm()">
                        <i class="fas fa-user-plus"></i> <span class="lang" data-key="addMember">添加成员</span>
                    </button>
                </div>
            </div>
            
            <!-- 添加成员表单 -->
            <div class="add-member-form" id="addMemberForm">
                <h3><i class="fas fa-user-plus"></i> <span class="lang" data-key="addNewMember">添加新成员</span></h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="memberName"><span class="lang" data-key="fullName">姓名</span></label>
                        <input type="text" id="memberName" placeholder="输入成员姓名">
                    </div>
                    <div class="form-group">
                        <label for="memberPosition"><span class="lang" data-key="position">职位</span></label>
                        <input type="text" id="memberPosition" placeholder="输入职位">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="memberDepartment"><span class="lang" data-key="department">部门</span></label>
                        <select id="memberDepartment">
                            <option value="management"><span class="lang" data-key="deptManagement">项目管理部</span></option>
                            <option value="tech"><span class="lang" data-key="deptTech">技术部</span></option>
                            <option value="analysis"><span class="lang" data-key="deptAnalysis">分析部</span></option>
                            <option value="marketing"><span class="lang" data-key="deptMarketing">市场部</span></option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="memberEmail"><span class="lang" data-key="email">邮箱</span></label>
                        <input type="email" id="memberEmail" placeholder="输入邮箱">
                    </div>
                </div>
                <div class="form-buttons">
                    <button class="btn btn-light" onclick="toggleMemberForm()">
                        <i class="fas fa-times"></i> <span class="lang" data-key="cancel">取消</span>
                    </button>
                    <button class="btn btn-success" onclick="addNewMember()">
                        <i class="fas fa-save"></i> <span class="lang" data-key="saveMember">保存成员</span>
                    </button>
                </div>
            </div>
            
            <div class="team-management">
                <div class="team-card">
                    <h3><i class="fas fa-user-tie"></i> <span class="lang" data-key="managementTeam">管理团队</span></h3>
                    <div id="management-team">
                        <!-- 管理团队成员将由JavaScript生成 -->
                    </div>
                </div>
                
                <div class="team-card">
                    <h3><i class="fas fa-laptop-code"></i> <span class="lang" data-key="devTeam">开发团队</span></h3>
                    <div id="dev-team">
                        <!-- 开发团队成员将由JavaScript生成 -->
                    </div>
                </div>
                
                <div class="team-card">
                    <h3><i class="fas fa-chart-line"></i> <span class="lang" data-key="kpiTeam">KPI分析团队</span></h3>
                    <div id="kpi-team">
                        <!-- KPI分析团队成员将由JavaScript生成 -->
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <table id="all-members-table">
                    <thead>
                        <tr>
                            <th width="20%"><span class="lang" data-key="member">成员</span></th>
                            <th width="20%"><span class="lang" data-key="position">职位</span></th>
                            <th width="20%"><span class="lang" data-key="department">部门</span></th>
                            <th width="20%"><span class="lang" data-key="contact">联系方式</span></th>
                            <th width="20%"><span class="lang" data-key="actions">操作</span></th>
                        </tr>
                    </thead>
                    <tbody id="all-members-body">
                        <!-- 所有成员列表将由JavaScript生成 -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 报表分析 -->
        <div class="content-section" id="reports">
            <div class="header">
                <h2><i class="fas fa-chart-bar"></i> <span class="lang" data-key="reportsAnalysis">报表分析</span></h2>
                <div class="user-controls">
                    <button class="btn btn-success" onclick="generateReport()">
                        <i class="fas fa-file-pdf"></i> <span class="lang" data-key="exportReport">导出报表</span>
                    </button>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-card">
                    <h3><i class="fas fa-bullseye"></i> <span class="lang" data-key="kpiAchievement">KPI达成率</span></h3>
                    <div class="chart-container">
                        <canvas id="kpiAchievementChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3><i class="fas fa-tasks"></i> <span class="lang" data-key="taskCompletion">任务完成率</span></h3>
                    <div class="chart-container">
                        <canvas id="taskCompletionChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3><i class="fas fa-user-clock"></i> <span class="lang" data-key="memberContribution">成员贡献度</span></h3>
                    <div class="chart-container">
                        <canvas id="memberContributionChart"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h3><i class="fas fa-project-diagram"></i> <span class="lang" data-key="projectProgress">项目进度趋势</span></h3>
                    <div class="chart-container">
                        <canvas id="projectProgressChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>© 2023 <span class="lang" data-key="systemName">团队协作式KPI周报系统</span> | <span class="lang" data-key="rights">保留所有权利</span></p>
            <p><span class="lang" data-key="lastUpdate">最后更新</span>: 2023-11-22 | <span class="lang" data-key="version">版本</span>: 2.1</p>
        </div>
    </div>
    
    <div class="notification" id="notification">通知消息</div>

    <script>
        // 多语言支持
        const translations = {
            zh: {
                navDashboard: "仪表盘",
                navKPI: "KPI周报",
                navTeam: "团队管理",
                navReports: "报表分析",
                teamMembers: "团队成员",
                online: "在线",
                editing: "编辑中",
                offline: "离线",
                currentPeriod: "当前周期",
                goToReport: "进入周报",
                viewReports: "查看报表",
                taskStatus: "任务状态分布",
                kpiProgress: "KPI进度追踪",
                recentUpdates: "最近更新",
                updatedBy: "更新人",
                section: "区域",
                time: "时间",
                update1: "完成客服团队培训",
                update2: "添加了新的市场分析",
                update3: "更新了团队信息",
                update4: "导出了本周报告",
                addRow: "添加新行",
                exportExcel: "导出Excel",
                saveData: "保存数据",
                coreKPI: "核心KPI (目标值)",
                keyActions: "支撑性关键行动/项目",
                weekReview: "本周重点回顾",
                completionStatus: "完成状态/结果",
                nextWeekPlan: "下周重点计划",
                expectedOutput: "预期输出/截止日",
                responsible: "责任人",
                status: "状态",
                teamManagement: "团队管理",
                addMember: "添加成员",
                addNewMember: "添加新成员",
                fullName: "姓名",
                position: "职位",
                department: "部门",
                email: "邮箱",
                cancel: "取消",
                saveMember: "保存成员",
                managementTeam: "管理团队",
                roleManager: "项目经理",
                roleLead: "团队负责人",
                devTeam: "开发团队",
                roleDev: "开发工程师",
                kpiTeam: "KPI分析团队",
                roleAnalyst: "分析师",
                member: "成员",
                contact: "联系方式",
                actions: "操作",
                deptManagement: "项目管理部",
                deptTech: "技术部",
                deptAnalysis: "分析部",
                deptMarketing: "市场部",
                reportsAnalysis: "报表分析",
                exportReport: "导出报表",
                kpiAchievement: "KPI达成率",
                taskCompletion: "任务完成率",
                memberContribution: "成员贡献度",
                projectProgress: "项目进度趋势",
                systemName: "团队协作式KPI周报系统",
                rights: "保留所有权利",
                lastUpdate: "最后更新",
                version: "版本",
                edit: "编辑",
                delete: "删除"
            },
            en: {
                navDashboard: "Dashboard",
                navKPI: "KPI Report",
                navTeam: "Team Management",
                navReports: "Reports",
                teamMembers: "Team Members",
                online: "Online",
                editing: "Editing",
                offline: "Offline",
                currentPeriod: "Current Period",
                goToReport: "Go to Report",
                viewReports: "View Reports",
                taskStatus: "Task Status Distribution",
                kpiProgress: "KPI Progress Tracking",
                recentUpdates: "Recent Updates",
                updatedBy: "Updated By",
                section: "Section",
                time: "Time",
                update1: "Completed customer service training",
                update2: "Added new market analysis",
                update3: "Updated team information",
                update4: "Exported weekly report",
                addRow: "Add New Row",
                exportExcel: "Export Excel",
                saveData: "Save Data",
                coreKPI: "Core KPI (Target)",
                keyActions: "Key Actions/Projects",
                weekReview: "Weekly Review",
                completionStatus: "Completion Status/Results",
                nextWeekPlan: "Next Week Plan",
                expectedOutput: "Expected Output/Deadline",
                responsible: "Responsible",
                status: "Status",
                teamManagement: "Team Management",
                addMember: "Add Member",
                addNewMember: "Add New Member",
                fullName: "Full Name",
                position: "Position",
                department: "Department",
                email: "Email",
                cancel: "Cancel",
                saveMember: "Save Member",
                managementTeam: "Management Team",
                roleManager: "Project Manager",
                roleLead: "Team Lead",
                devTeam: "Development Team",
                roleDev: "Developer",
                kpiTeam: "KPI Analysis Team",
                roleAnalyst: "Analyst",
                member: "Member",
                contact: "Contact",
                actions: "Actions",
                deptManagement: "Project Management",
                deptTech: "Technology",
                deptAnalysis: "Analysis",
                deptMarketing: "Marketing",
                reportsAnalysis: "Reports Analysis",
                exportReport: "Export Report",
                kpiAchievement: "KPI Achievement Rate",
                taskCompletion: "Task Completion Rate",
                memberContribution: "Member Contribution",
                projectProgress: "Project Progress Trend",
                systemName: "Team KPI Collaboration System",
                rights: "All Rights Reserved",
                lastUpdate: "Last Update",
                version: "Version",
                edit: "Edit",
                delete: "Delete"
            }
        };

        // 当前语言
        let currentLang = 'zh';
        
        // 团队成员数据
        let teamMembers = [
            { id: 1, name: "张明", position: "项目经理", department: "management", email: "zhang@example.com", status: "online" },
            { id: 2, name: "王芳", position: "团队负责人", department: "management", email: "wang@example.com", status: "editing" },
            { id: 3, name: "李华", position: "高级开发工程师", department: "tech", email: "li@example.com", status: "online" },
            { id: 4, name: "陈伟", position: "前端开发工程师", department: "tech", email: "chen@example.com", status: "offline" },
            { id: 5, name: "赵雷", position: "数据分析师", department: "analysis", email: "zhao@example.com", status: "online" }
        ];
        
        // 切换语言
        function setLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang').forEach(element => {
                const key = element.getAttribute('data-key');
                if (translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            
            // 更新UI元素
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.lang-btn[data-lang="${lang}"]`).classList.add('active');
            
            showNotification(lang === 'zh' ? '语言已切换到中文' : 'Language switched to English');
        }
        
        // 切换内容区域
        function switchSection(sectionId) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            document.querySelector(`.nav-item[data-section="${sectionId}"]`).classList.add('active');
            
            // 如果是报表页面，重新初始化图表
            if (sectionId === 'reports') {
                initReportCharts();
            }
        }
        
        // 显示通知
        function showNotification(message, duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, duration);
        }
        
        // 初始化仪表盘图表
        function initDashboardCharts() {
            // 任务状态分布图
            const taskCtx = document.getElementById('taskStatusChart').getContext('2d');
            new Chart(taskCtx, {
                type: 'doughnut',
                data: {
                    labels: [
                        translations[currentLang].status + ' (' + (currentLang === 'zh' ? '计划中' : 'Planned') + ')',
                        translations[currentLang].status + ' (' + (currentLang === 'zh' ? '进行中' : 'In Progress') + ')',
                        translations[currentLang].status + ' (' + (currentLang === 'zh' ? '已完成' : 'Completed') + ')',
                        translations[currentLang].status + ' (' + (currentLang === 'zh' ? '受阻' : 'Blocked') + ')'
                    ],
                    datasets: [{
                        data: [15, 25, 45, 15],
                        backgroundColor: [
                            '#f0f7ff',
                            '#fff8e6',
                            '#e8f7ee',
                            '#fce8e8'
                        ],
                        borderColor: [
                            '#c0d9f5',
                            '#ffeeba',
                            '#c3e6cb',
                            '#f5c6cb'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: translations[currentLang].taskStatus
                        }
                    }
                }
            });
            
            // KPI进度追踪图
            const kpiCtx = document.getElementById('kpiProgressChart').getContext('2d');
            new Chart(kpiCtx, {
                type: 'bar',
                data: {
                    labels: ['CSAT', '准时率', '销售额', '员工满意度', '产品质量'],
                    datasets: [{
                        label: translations[currentLang].kpiProgress,
                        data: [85, 92, 78, 88, 95],
                        backgroundColor: '#2c87e6',
                        borderColor: '#1a6dcc',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // 初始化报表图表
        function initReportCharts() {
            // 清除旧图表
            const chartIds = ['kpiAchievementChart', 'taskCompletionChart', 'memberContributionChart', 'projectProgressChart'];
            chartIds.forEach(id => {
                const chartElement = document.getElementById(id);
                if (chartElement && chartElement.chart) {
                    chartElement.chart.destroy();
                }
            });
            
            // KPI达成率
            const achievementCtx = document.getElementById('kpiAchievementChart').getContext('2d');
            const achievementChart = new Chart(achievementCtx, {
                type: 'bar',
                data: {
                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                    datasets: [{
                        label: translations[currentLang].kpiAchievement,
                        data: [75, 82, 90, 88],
                        backgroundColor: '#28a745',
                        borderColor: '#1e7e34',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
            document.getElementById('kpiAchievementChart').chart = achievementChart;
            
            // 任务完成率
            const completionCtx = document.getElementById('taskCompletionChart').getContext('2d');
            const completionChart = new Chart(completionCtx, {
                type: 'line',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月'],
                    datasets: [{
                        label: translations[currentLang].taskCompletion,
                        data: [70, 75, 80, 82, 85, 88, 90, 92, 93, 95, 96],
                        backgroundColor: 'rgba(44, 135, 230, 0.1)',
                        borderColor: '#2c87e6',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
            document.getElementById('taskCompletionChart').chart = completionChart;
            
            // 成员贡献度
            const contributionCtx = document.getElementById('memberContributionChart').getContext('2d');
            const contributionChart = new Chart(contributionCtx, {
                type: 'radar',
                data: {
                    labels: [
                        translations[currentLang].kpiProgress,
                        translations[currentLang].taskCompletion,
                        translations[currentLang].expectedOutput,
                        translations[currentLang].completionStatus,
                        translations[currentLang].responsible
                    ],
                    datasets: [
                        {
                            label: '张明',
                            data: [85, 90, 88, 92, 95],
                            backgroundColor: 'rgba(40, 167, 69, 0.2)',
                            borderColor: '#28a745',
                            pointBackgroundColor: '#28a745'
                        },
                        {
                            label: '王芳',
                            data: [92, 88, 95, 90, 85],
                            backgroundColor: 'rgba(44, 135, 230, 0.2)',
                            borderColor: '#2c87e6',
                            pointBackgroundColor: '#2c87e6'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });
            document.getElementById('memberContributionChart').chart = contributionChart;
            
            // 项目进度趋势
            const progressCtx = document.getElementById('projectProgressChart').getContext('2d');
            const progressChart = new Chart(progressCtx, {
                type: 'bar',
                data: {
                    labels: ['项目A', '项目B', '项目C', '项目D', '项目E'],
                    datasets: [{
                        label: translations[currentLang].projectProgress,
                        data: [75, 60, 90, 45, 80],
                        backgroundColor: [
                            '#2c87e6',
                            '#ffc107',
                            '#28a745',
                            '#dc3545',
                            '#6f42c1'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
            document.getElementById('projectProgressChart').chart = progressChart;
        }
        
        // KPI表格功能
        const initialData = [
            {
                kpi: "客户满意度 (CSAT) ≥ 90%",
                action: "1. 提升响应速度",
                review: "1.1 完成客服团队新响应流程培训 (计划内)",
                status: "✅ 完成，全员参与",
                plan: "1.1 监控新流程执行情况，收集首周反馈",
                output: "问题单平均响应时间 < 2小时 (目标)",
                responsible: "张明",
                state: "planned"
            },
            {
                kpi: "客户满意度 (CSAT) ≥ 90%",
                action: "1. 提升响应速度",
                review: "*临时*：处理XX重大客户投诉 (新增)",
                status: "✅ 解决，客户接受方案",
                plan: "1.2 分析XX投诉根因，提出预防措施报告",
                output: "根因分析报告 (下周五前)",
                responsible: "李华",
                state: "in-progress"
            },
            {
                kpi: "产品上线准时率 ≥ 95%",
                action: "3. 项目A冲刺阶段",
                review: "3.1 完成模块X开发与内部测试 (计划内)",
                status: "✅ 完成，测试通过",
                plan: "3.1 进行模块X用户验收测试 (UAT)",
                output: "UAT报告，问题清单 (下周三前)",
                responsible: "陈伟",
                state: "planned"
            },
            {
                kpi: "销售额增长 ≥ 15%",
                action: "2. 新市场拓展",
                review: "2.1 完成拉丁美洲市场分析报告",
                status: "✅ 完成，已提交管理层",
                plan: "2.1 制定墨西哥市场进入策略",
                output: "市场进入策略文档 (下周五前)",
                responsible: "赵雷",
                state: "in-progress"
            },
            {
                kpi: "员工满意度 ≥ 85%",
                action: "4. 团队文化建设",
                review: "4.1 组织团队建设活动 (计划内)",
                status: "⚠️ 活动推迟至下周",
                plan: "4.1 举办季度团队建设活动",
                output: "活动完成，参与率 > 90%",
                responsible: "王芳",
                state: "blocked"
            }
        ];
        
        // 添加新行
        function addNewRow() {
            const tbody = document.getElementById('table-body');
            const newRow = document.createElement('tr');
            
            newRow.innerHTML = `
                <td><input type="text" placeholder="${translations[currentLang].coreKPI}"></td>
                <td><input type="text" placeholder="${translations[currentLang].keyActions}"></td>
                <td><textarea placeholder="${translations[currentLang].weekReview}"></textarea></td>
                <td><textarea placeholder="${translations[currentLang].completionStatus}"></textarea></td>
                <td><textarea placeholder="${translations[currentLang].nextWeekPlan}"></textarea></td>
                <td><textarea placeholder="${translations[currentLang].expectedOutput}"></textarea></td>
                <td><input type="text" placeholder="${translations[currentLang].responsible}"></td>
                <td>
                    <select class="status-select status-planned">
                        <option value="planned" selected>${translations[currentLang].status} (${currentLang === 'zh' ? '计划中' : 'Planned'})</option>
                        <option value="in-progress">${translations[currentLang].status} (${currentLang === 'zh' ? '进行中' : 'In Progress'})</option>
                        <option value="completed">${translations[currentLang].status} (${currentLang === 'zh' ? '已完成' : 'Completed'})</option>
                        <option value="blocked">${translations[currentLang].status} (${currentLang === 'zh' ? '受阻' : 'Blocked'})</option>
                    </select>
                </td>
                <td><button class="remove-row" onclick="removeRow(this)">×</button></td>
            `;
            
            tbody.appendChild(newRow);
            showNotification(currentLang === 'zh' ? '新行已添加' : 'New row added');
        }
        
        // 删除行
        function removeRow(button) {
            const row = button.closest('tr');
            row.remove();
            showNotification(currentLang === 'zh' ? '行已删除' : 'Row removed');
        }
        
        // 导出到Excel
        function exportToExcel() {
            const table = document.getElementById('kpi-table');
            const ws = XLSX.utils.table_to_sheet(table);
            
            // 创建工作簿并添加工作表
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "KPI周报");
            
            // 生成Excel文件并下载
            const today = new Date();
            const dateStr = `${today.getFullYear()}-${today.getMonth()+1}-${today.getDate()}`;
            XLSX.writeFile(wb, `团队KPI周报_${dateStr}.xlsx`);
            showNotification(currentLang === 'zh' ? 'Excel文件已导出' : 'Excel exported');
        }
        
        // 保存数据
        function saveData() {
            showNotification(currentLang === 'zh' ? '数据已保存' : 'Data saved');
        }
        
        // 生成报表
        function generateReport() {
            showNotification(currentLang === 'zh' ? '报表生成中...' : 'Generating report...');
        }
        
        // 切换添加成员表单显示状态
        function toggleMemberForm() {
            const form = document.getElementById('addMemberForm');
            form.classList.toggle('active');
        }
        
        // 添加新成员
        function addNewMember() {
            const name = document.getElementById('memberName').value;
            const position = document.getElementById('memberPosition').value;
            const department = document.getElementById('memberDepartment').value;
            const email = document.getElementById('memberEmail').value;
            
            if (!name || !position || !email) {
                showNotification(currentLang === 'zh' ? '请填写所有必填字段' : 'Please fill in all required fields');
                return;
            }
            
            const newMember = {
                id: teamMembers.length + 1,
                name: name,
                position: position,
                department: department,
                email: email,
                status: 'online'
            };
            
            teamMembers.push(newMember);
            renderTeamMembers();
            
            // 重置表单
            document.getElementById('memberName').value = '';
            document.getElementById('memberPosition').value = '';
            document.getElementById('memberEmail').value = '';
            
            toggleMemberForm();
            showNotification(currentLang === 'zh' ? '成员已添加' : 'Member added');
        }
        
        // 删除成员
        function deleteMember(id) {
            teamMembers = teamMembers.filter(member => member.id !== id);
            renderTeamMembers();
            showNotification(currentLang === 'zh' ? '成员已删除' : 'Member deleted');
        }
        
        // 渲染团队成员
        function renderTeamMembers() {
            // 更新团队成员数量
            document.getElementById('member-count').textContent = teamMembers.length;
            
            // 渲染侧边栏团队成员
            const teamList = document.getElementById('team-members-list');
            teamList.innerHTML = '';
            
            teamMembers.forEach(member => {
                const memberEl = document.createElement('div');
                memberEl.className = 'member';
                
                let statusClass = '';
                let statusText = '';
                
                if (member.status === 'online') {
                    statusClass = 'status-online';
                    statusText = translations[currentLang].online;
                } else if (member.status === 'editing') {
                    statusClass = 'status-editing';
                    statusText = translations[currentLang].editing;
                } else {
                    statusClass = 'status-offline';
                    statusText = translations[currentLang].offline;
                }
                
                memberEl.innerHTML = `
                    <div class="member-avatar">
                        <span>${member.name.charAt(0)}</span>
                        <div class="member-status ${statusClass}"></div>
                    </div>
                    <div>${member.name} (${statusText})</div>
                `;
                teamList.appendChild(memberEl);
            });
            
            // 按部门分组渲染
            const departments = {
                management: document.getElementById('management-team'),
                tech: document.getElementById('dev-team'),
                analysis: document.getElementById('kpi-team')
            };
            
            // 清空部门容器
            Object.values(departments).forEach(container => {
                container.innerHTML = '';
            });
            
            // 添加成员到相应部门
            teamMembers.forEach(member => {
                if (departments[member.department]) {
                    const memberEl = document.createElement('div');
                    memberEl.className = 'member-details';
                    
                    memberEl.innerHTML = `
                        <div class="member-avatar">${member.name.charAt(0)}</div>
                        <div>
                            <div><strong>${member.name}</strong></div>
                            <div>${member.position}</div>
                        </div>
                    `;
                    departments[member.department].appendChild(memberEl);
                }
            });
            
            // 渲染所有成员表格
            const allMembersBody = document.getElementById('all-members-body');
            allMembersBody.innerHTML = '';
            
            teamMembers.forEach(member => {
                const row = document.createElement('tr');
                
                let deptText = '';
                switch(member.department) {
                    case 'management':
                        deptText = translations[currentLang].deptManagement;
                        break;
                    case 'tech':
                        deptText = translations[currentLang].deptTech;
                        break;
                    case 'analysis':
                        deptText = translations[currentLang].deptAnalysis;
                        break;
                    case 'marketing':
                        deptText = translations[currentLang].deptMarketing;
                        break;
                    default:
                        deptText = member.department;
                }
                
                row.innerHTML = `
                    <td>${member.name}</td>
                    <td>${member.position}</td>
                    <td>${deptText}</td>
                    <td>${member.email}</td>
                    <td>
                        <button class="action-btn btn-light">
                            <i class="fas fa-edit"></i> ${translations[currentLang].edit}
                        </button>
                        <button class="action-btn btn-danger" onclick="deleteMember(${member.id})">
                            <i class="fas fa-trash"></i> ${translations[currentLang].delete}
                        </button>
                    </td>
                `;
                allMembersBody.appendChild(row);
            });
        }
        
        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 设置当前周
            const now = new Date();
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay() + (now.getDay() === 0 ? -6 : 1));
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);
            
            const formatDate = date => `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
            document.getElementById('current-week').textContent = 
                `${formatDate(startOfWeek)} - ${formatDate(endOfWeek)}`;
            document.getElementById('current-week-kpi').textContent = 
                `${formatDate(startOfWeek)} - ${formatDate(endOfWeek)}`;
            
            // 加载KPI表格数据
            const tbody = document.getElementById('table-body');
            initialData.forEach(item => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td><input type="text" value="${item.kpi || ''}"></td>
                    <td><input type="text" value="${item.action || ''}"></td>
                    <td><textarea>${item.review || ''}</textarea></td>
                    <td><textarea>${item.status || ''}</textarea></td>
                    <td><textarea>${item.plan || ''}</textarea></td>
                    <td><textarea>${item.output || ''}</textarea></td>
                    <td><input type="text" value="${item.responsible || ''}"></td>
                    <td>
                        <select class="status-select">
                            <option value="planned" ${item.state === 'planned' ? 'selected' : ''}>${translations[currentLang].status} (${currentLang === 'zh' ? '计划中' : 'Planned'})</option>
                            <option value="in-progress" ${item.state === 'in-progress' ? 'selected' : ''}>${translations[currentLang].status} (${currentLang === 'zh' ? '进行中' : 'In Progress'})</option>
                            <option value="completed" ${item.state === 'completed' ? 'selected' : ''}>${translations[currentLang].status} (${currentLang === 'zh' ? '已完成' : 'Completed'})</option>
                            <option value="blocked" ${item.state === 'blocked' ? 'selected' : ''}>${translations[currentLang].status} (${currentLang === 'zh' ? '受阻' : 'Blocked'})</option>
                        </select>
                    </td>
                    <td><button class="remove-row" onclick="removeRow(this)">×</button></td>
                `;
                
                // 设置状态样式
                const select = row.querySelector('select');
                select.classList.add(`status-${item.state || 'planned'}`);
                
                tbody.appendChild(row);
            });
            
            // 初始化图表
            initDashboardCharts();
            
            // 渲染团队成员
            renderTeamMembers();
            
            // 菜单切换
            document.getElementById('menuToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
            });
            
            // 语言切换
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    setLanguage(this.getAttribute('data-lang'));
                });
            });
            
            // 导航项点击
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    switchSection(this.getAttribute('data-section'));
                });
            });
            
            // 用户名修改
            document.getElementById('username').addEventListener('change', function() {
                showNotification(currentLang === 'zh' ? `用户名已更新为: ${this.value}` : `Username updated to: ${this.value}`);
            });
        });
    </script>
</body>
</html>
